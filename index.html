<input id="sess" type="text" value="SessionID">
<input id="actName" type="text" value="Account Name">
<input id="tabIdx" type="number" value="0">
<button onclick="handleClick()">Run</button>
<script>
	const $ = (q) => document.querySelector(q);
	
	function handleClick(){
		const sess = $("#sess").value,
		act = $("#actName").value,
		tab = $("#tabIdx").value;
		console.log(getHortiMods(act, tab, sess));
	}
  
	function getHortiMods(name, index, sessId){
		const xhr = new XMLHttpRequest();
		document.cookie = `POESESSID=${sessId}`;
		xhr.open("GET", `https://www.pathofexile.com/character-window/get-stash-items?league=Harvest&tabIndex=${index}&accountName=${name}`, false);
		xhr.withCredentials = true;
		xhr.send(null);
		var out = JSON.parse(xhr.responseText);
		var mods = [];
		for (var item of out.items) {
			if (!item.craftedMods) { continue; }
			mods = mods.concat(item.craftedMods);
		}
		return mods;
	}
</script>
